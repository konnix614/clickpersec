<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Click Speed Test</title>
<style>
  body {
    font-family: Arial, sans-serif;
    text-align: center;
    gap: 20px;
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    min-height: 100vh;
    justify-content: center;
    background: #5D3A8C; /* violet foncé */
    color: #ffffff; /* texte blanc pour contraster avec le violet */
}

  h1 {
    margin-top: 20px;
  }

  input, .click-button, .timer-button {
    margin: 10px;
  }

  .click-button {
    width: 200px;           /* largeur fixe */
    height: 80px;           /* hauteur fixe */
    font-size: 18px;        /* texte un peu plus petit */
    margin: 15px;
    cursor: pointer;
    border: none;
    border-radius: 50px;    /* coins arrondis mais subtils */
    background: #000000;    /* violet assorti */
    color: #fff;
    transition: transform 0.1s, background 0.2s;
}

/* Effet au survol */
.click-button:hover {
    background: #cedb6f; 
    transform: scale(1.05);

  .timer-button {
    padding: 10px 20px;
    margin: 5px;
    font-size: 16px;
    cursor: pointer;
  }

  #timer {
    font-size: 64px;
    margin-bottom: 20px;
  }

  #score {
    font-size: 28px;
    margin-top: 20px;
  }

  #results {
    position: fixed;
    bottom: 20px;
    width: 100%;
    text-align: center;
    font-size: 24px;
  }

  #leaderboard {
    margin-top: 30px;
  }

  #leaderboard h2 {
    margin-bottom: 10px;
  }

  #leaderboard ul {
    list-style: none;
    padding: 0;
    font-size: 18px;
  }

</style>
</head>
<body>

<h1>Test de clics par seconde</h1>

<div>
  <span>Choisis ton pseudo : </span>
  <input type="text" id="username" placeholder="Ton pseudo">
</div>

<div>
  <span>Choisis la durée : </span>
  <button class="timer-button" data-time="3">3s</button>
  <button class="timer-button" data-time="5">5s</button>
  <button class="timer-button" data-time="10">10s</button>
  <button class="timer-button" data-time="20">20s</button>
  <button class="timer-button" data-time="30">30s</button>
</div>

<div id="timer">Temps restant : 0s</div>
<button class="click-button" id="btn1">Clique-moi !</button>
<button class="click-button" id="btn2">Ou moi !</button>

<div id="score">CPS : 0</div>
<div id="results"></div>

<div id="leaderboard">
  <h2>Classement (meilleurs CPS)</h2>
  <ul id="board-list"></ul>
</div>

<script>
let clicks = 0;
let timeLeft = 0;
let timerRunning = false;
let timerInterval;
let currentDuration = 0;

const buttons = document.querySelectorAll('.click-button');
const timerButtons = document.querySelectorAll('.timer-button');
const scoreDisplay = document.getElementById('score');
const timerDisplay = document.getElementById('timer');
const resultsDisplay = document.getElementById('results');
const boardList = document.getElementById('board-list');
const usernameInput = document.getElementById('username');

// Récupérer le leaderboard depuis localStorage ou créer un objet vide
let leaderboard = JSON.parse(localStorage.getItem('clickLeaderboard')) || {};

// Fonction pour sauvegarder leaderboard dans localStorage
function saveLeaderboard() {
  localStorage.setItem('clickLeaderboard', JSON.stringify(leaderboard));
}

// Mettre à jour le classement pour une durée
function updateLeaderboard(duration, user, cps) {
  if (!leaderboard[duration]) leaderboard[duration] = [];
  leaderboard[duration].push({user, cps});
  leaderboard[duration].sort((a, b) => b.cps - a.cps);
  if (leaderboard[duration].length > 5) leaderboard[duration].pop(); // top 5
  saveLeaderboard();
  displayLeaderboard(duration);
}

// Afficher le classement
function displayLeaderboard(duration) {
  boardList.innerHTML = '';
  if (!leaderboard[duration]) return;
  leaderboard[duration].forEach((entry, index) => {
    const li = document.createElement('li');
    li.textContent = `#${index + 1} : ${entry.user} - ${entry.cps} CPS (${duration}s)`;
    boardList.appendChild(li);
  });
}

// Fonction pour démarrer le test
function startTest(duration) {
  const user = usernameInput.value.trim();
  if (!user) {
    alert("Entre un pseudo avant de commencer !");
    return;
  }

  clicks = 0;
  timeLeft = duration;
  currentDuration = duration;
  timerRunning = true;
  scoreDisplay.textContent = `CPS : 0`;
  resultsDisplay.textContent = '';
  timerDisplay.textContent = `Temps restant : ${timeLeft}s`;

  clearInterval(timerInterval);

  timerInterval = setInterval(() => {
    timeLeft--;
    timerDisplay.textContent = `Temps restant : ${timeLeft}s`;
    if (timeLeft <= 0) {
      clearInterval(timerInterval);
      timerRunning = false;
      const cps = (clicks / duration).toFixed(2);
      resultsDisplay.textContent = `Temps écoulé ! ${user} - Clics : ${clicks}, CPS : ${cps}`;
      updateLeaderboard(duration, user, cps);
    }
  }, 1000);
}

// Clic sur durée
timerButtons.forEach(btn => {
  btn.addEventListener('click', () => {
    const duration = parseInt(btn.getAttribute('data-time'));
    startTest(duration);
  });
});

// Clic sur boutons de test
buttons.forEach(button => {
  button.addEventListener('click', () => {
    if (!timerRunning) return;
    clicks++;
    scoreDisplay.textContent = `CPS : ${clicks}`;
  });
});

// Afficher les classements existants pour chaque durée au chargement
Object.keys(leaderboard).forEach(duration => displayLeaderboard(duration));

</script>
</body>
</html>
